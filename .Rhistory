ungroup() %>%
mutate(labell = round(labels/sum(weights), digits = 2))
trab_conta_propria_INSS$labell = trab_conta_propria_INSS$labell * 100
trab_conta_propria_INSS = trab_conta_propria_INSS %>%
select(year_quarter, higher_educ_label, higher_educ_level, labell) %>%
distinct() %>%
mutate(labelll = case_when(higher_educ_label == "Uneducated and Primary School Incomplete" & year_quarter == "2019_1" ~ 25,
higher_educ_label == "Primary School Complete and Incomplete High School" & year_quarter == "2019_1" ~ 14,
higher_educ_label == "Complete High School and Incomplete College Degree" & year_quarter == "2019_1" ~ 38,
higher_educ_label == "Complete College Degree" & year_quarter == "2019_1" ~ 24)) %>%
filter(!is.na(labelll))
trab_conta_propria_INSS = trab_conta_propria_INSS[c(2,3,5,6),]
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Education Level of Self-Employed Social Security Contributors in 2019") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y")
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Education Level of Self-Employed Social Security Contributors in 2019") +
theme_minimal(base_size = 15) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y")
library(ggpubr)
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
warnings()
library(extrafont)
font_import(path = "C:/Users/Fredie/AppData/Local/Microsoft/Windows/Fonts")
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Education Level of Self-Employed Social Security Contributors in 2019") +
theme_minimal(base_size = 15) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y")
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Education Level of Self-Employed Non-Social Security Contributors in 2019") +
theme_minimal(base_size = 15) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y")
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Education Level of Self-Employed Non-Social Security Contributors in 2019") +
theme_minimal(base_size = 15) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Education Level of Self-Employed Social Security Contributors in 2019") +
theme_minimal(base_size = 15) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal(base_size = 15) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal(base_size = 15) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Social Security Contributors") +
theme_minimal(base_size = 15) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal(base_size = 15) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
ggsave("self_employed.png", path = "./output", width = 13.66,
height = 7.05)
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Social Security Contributors") +
theme_minimal(base_size = 18) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal(base_size = 18) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
ggsave("self_employed.png", path = "./output", width = 13.66,
height = 7.05)
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.title = element_text(size = 15),
legend.text = element_text(size = 15)) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.text = element_text(size = 15)) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),,
legend.text = element_text(size = 15)) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.text = element_text(size = 15)) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
warnings()
font_import(path = "C:/Users/Fredie/AppData/Local/Microsoft/Windows/Fonts")
loadfonts(device = "win")
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.text = element_text(size = 15)) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.text = element_text(size = 15)) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.text = element_text(size = 20)) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.text = element_text(size = 20)) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.text = element_text(size = 20)) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=4,byrow=TRUE))
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.text = element_text(size = 20)) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=4,byrow=TRUE))
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
ggsave("self_employed.png", path = "./output", width = 13.66,
height = 7.05)
