mutate(peso_estudo = wtd.mean(years_of_study, weights = weights)) %>%
mutate(var = wtd.var(years_of_study, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_estudo, sd)
View(dat_estudo_priv_formal)
dat_salario_informal_priv = df %>%
filter(job_function %in% c(3) & worker == 1 & work_category == 2 &
!is.na(monthly_work_income)) %>%
select(job_function, worker, work_category, monthly_work_income, weights) %>%
mutate(peso_salario = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(var = wtd.var(monthly_work_income, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_salario, sd)
View(dat_salario_informal_priv)
rm(dat_salario_informal_priv)
dat_salario_formal_priv = df %>%
filter(job_function %in% c(3) & worker == 1 & work_category == 1 &
!is.na(monthly_work_income)) %>%
select(job_function, worker, work_category, monthly_work_income, weights) %>%
mutate(peso_salario = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(var = wtd.var(monthly_work_income, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_salario, sd)
View(dat_salario_formal_priv)
dat_estudo_priv_informal = df %>%
filter(job_function %in% c(3) & worker == 1 & work_category == 2) %>%
select(job_function, worker, work_category, years_of_study, weights) %>%
mutate(peso_estudo = wtd.mean(years_of_study, weights = weights)) %>%
mutate(var = wtd.var(years_of_study, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_estudo, sd)
View(dat_estudo_priv_formal)
View(dat_estudo_priv_informal)
dat_salario_informal_priv = df %>%
filter(job_function %in% c(3) & worker == 1 & work_category == 2 &
!is.na(monthly_work_income)) %>%
select(job_function, worker, work_category, monthly_work_income, weights) %>%
mutate(peso_salario = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(var = wtd.var(monthly_work_income, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_salario, sd)
rm(dat_estudo_inat, dat_estudo_priv_formal, dat_estudo_priv_informal, dat_salario_formal_priv)
dat_salario_informal_priv = df %>%
filter(job_function %in% c(3) & worker == 1 & work_category == 2 &
!is.na(monthly_work_income)) %>%
select(job_function, worker, work_category, monthly_work_income, weights) %>%
mutate(peso_salario = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(var = wtd.var(monthly_work_income, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_salario, sd)
View(dat_salario_informal_priv)
dat_estud_public_formal = df %>%
filter(job_function %in% c(4) & worker == 1 & work_category %in% c(5,7)) %>%
select(job_function, worker, work_category, years_of_study, weights) %>%
mutate(peso_estudo = wtd.mean(years_of_study, weights = weights)) %>%
mutate(var = wtd.var(years_of_study, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_estudo, sd)
View(dat_estud_public_formal)
dat_salario_formal_public = df %>%
filter(job_function %in% c(4) & worker == 1 & work_category %in% c(5,7) &
!is.na(monthly_work_income)) %>%
select(job_function, worker, work_category, monthly_work_income, weights) %>%
mutate(peso_salario = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(var = wtd.var(monthly_work_income, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_salario, sd)
View(dat_salario_formal_public)
View(dat_estud_public_formal)
rm(dat_salario_formal_public, dat_salario_informal_priv, dat_estud_public_formal)
dat_estudo_public_informal = df %>%
filter(job_function %in% c(4) & worker == 1 & work_category == 6) %>%
select(job_function, worker, work_category, years_of_study, weights) %>%
mutate(peso_estudo = wtd.mean(years_of_study, weights = weights)) %>%
mutate(var = wtd.var(years_of_study, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_estudo, sd)
View(dat_estudo_public_informal)
dat_salario_informal_public = df %>%
filter(job_function %in% c(4) & worker == 1 & work_category == 6 &
!is.na(monthly_work_income)) %>%
select(job_function, worker, work_category, monthly_work_income, weights) %>%
mutate(peso_salario = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(var = wtd.var(monthly_work_income, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_salario, sd)
View(dat_salario_informal_public)
dat_estudo_empreg_formal = df %>%
filter(job_function %in% c(5) & worker == 1 & cnpj == 1) %>%
select(job_function, worker, cnpj, years_of_study, weights) %>%
mutate(peso_estudo = wtd.mean(years_of_study, weights = weights)) %>%
mutate(var = wtd.var(years_of_study, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_estudo, sd)
View(dat_estudo_empreg_formal)
dat_salario_formal_empreg = df %>%
filter(job_function %in% c(5) & worker == 1 & cnpj == 1 &
!is.na(monthly_work_income)) %>%
select(job_function, worker, cnpj, monthly_work_income, weights) %>%
mutate(peso_salario = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(var = wtd.var(monthly_work_income, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_salario, sd)
View(dat_salario_formal_empreg)
rm(dat_estudo_empreg_formal, dat_estudo_public_informal, dat_salario_formal_empreg, dat_salario_informal_public)
dat_estudo_empreg_informal = df %>%
filter(job_function %in% c(5) & worker == 1 & cnpj == 2) %>%
select(job_function, worker, cnpj, years_of_study, weights) %>%
mutate(peso_estudo = wtd.mean(years_of_study, weights = weights)) %>%
mutate(var = wtd.var(years_of_study, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_estudo, sd)
View(dat_estudo_empreg_informal)
dat_salario_informal_empreg = df %>%
filter(job_function %in% c(5) & worker == 1 & cnpj == 2 &
!is.na(monthly_work_income)) %>%
select(job_function, worker, cnpj, monthly_work_income, weights) %>%
mutate(peso_salario = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(var = wtd.var(monthly_work_income, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_salario, sd)
View(dat_salario_informal_empreg)
dat_estudo_self_employed_formal = df %>%
filter(job_function %in% c(6) & worker == 1 & social_security_taxpayer == 1) %>%
select(job_function, worker, social_security_taxpayer, years_of_studyweights) %>%
mutate(peso_estudo = wtd.mean(years_of_study, weights = weights)) %>%
mutate(var = wtd.var(years_of_study, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_estudo, sd)
dat_estudo_self_employed_formal = df %>%
filter(job_function %in% c(6) & worker == 1 & social_security_taxpayer == 1) %>%
select(job_function, worker, social_security_taxpayer, years_of_study,weights) %>%
mutate(peso_estudo = wtd.mean(years_of_study, weights = weights)) %>%
mutate(var = wtd.var(years_of_study, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_estudo, sd)
View(dat_estudo_self_employed_formal)
dat_salario_formal_self_employed = df %>%
filter(job_function %in% c(6) & worker == 1 & social_security_taxpayer == 1 &
!is.na(monthly_work_income)) %>%
select(job_function, worker, social_security_taxpayer, monthly_work_income, weights) %>%
mutate(peso_salario = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(var = wtd.var(monthly_work_income, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_salario, sd)
View(dat_salario_formal_self_employed)
dat_estudo_self_employed_informal = df %>%
filter(job_function %in% c(6) & worker == 1 & social_security_taxpayer == 2) %>%
select(job_function, worker, social_security_taxpayer, years_of_study,weights) %>%
mutate(peso_estudo = wtd.mean(years_of_study, weights = weights)) %>%
mutate(var = wtd.var(years_of_study, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_estudo, sd)
View(dat_estudo_self_employed_informal)
dat_salario_informal_self_employed = df %>%
filter(job_function %in% c(6) & worker == 1 & social_security_taxpayer == 2 &
!is.na(monthly_work_income)) %>%
select(job_function, worker, social_security_taxpayer, monthly_work_income, weights = weights) %>%
mutate(var = wtd.var(monthly_work_income, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_salario, sd)
dat_salario_informal_self_employed = df %>%
filter(job_function %in% c(6) & worker == 1 & social_security_taxpayer == 2 &
!is.na(monthly_work_income)) %>%
select(job_function, worker, social_security_taxpayer, monthly_work_income, weights = weights) %>%
mutate(peso_salario = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(var = wtd.var(monthly_work_income, weights = weights)) %>%
mutate(sd = sqrt(var)) %>%
summarise(peso_salario, sd)
View(dat_salario_informal_self_employed)
source("./analysis/_descriptive_table.R")
df = read_rds("./input/painel_2019.rds")
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(new_label = wtd.mean(labell, weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(new_label = wtd.mean(higher_educ_level, weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2))
View(empreg_formal)
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = wtd.mean(worker, weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = wtd.mean(higher_educ_level, weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = wtd.mean(labell, weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = wtd.mean(labels, weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj, weights) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = wtd.mean(labels, weights))
View(df)
View(empreg_formal)
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj, weights) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = wtd.mean(higher_educ_level, weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj, weights) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = wtd.mean(labels, weights = weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj, weights) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = wtd.mean(worker, weights = weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj, weights) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = wtd.mean(label, weights = weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj, weights) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = wtd.mean(labell, weights = weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj, weights) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = wtd.mean(labels, weights = weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj, weights) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = (labels * weights)/sum(weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj, weights) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = (worker* weights)/sum(weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj, weights) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = (labels * weights)/sum(weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj, weights) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = (higher_educ_level* weights)/sum(weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj, weights) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = (higher_educ_label* weights)/sum(weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj, weights) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = (labels* weights)/sum(weights))
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj, weights) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = (cnpj* weights)/sum(weights))
View(empreg_formal)
empreg_formal = df %>%
filter(year_quarter %in% c("2019_1", "2019_2", "2019_3", "2019_4")) %>%
select(signed_work_card, higher_educ_level, year_quarter,
job_function, worker, cnpj, weights) %>%
filter(job_function == 5 & cnpj == 1 & worker == 1)  %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incompleted",
higher_educ_level %in% c(3) ~ "Primary School Completed",
higher_educ_level %in% c(4) ~ "High School Incompleted",
higher_educ_level %in% c(5) ~ "High School Completed",
higher_educ_level %in% c(6) ~ "College Degree Incompleted",
higher_educ_level %in% c(7) ~ "College Degree Completed"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2)) %>%
mutate(peso = (worker* weights)/sum(weights))
rm(empreg_formal)
memory.limit(50000)
base = readr::read_rds(".inpu/painel_2017_1_4.rds")
base = readr::read_rds(".input/painel_2017_1_4.rds")
base = readr::read_rds("./input/painel_2017_1_4.rds")
View(base)
rm(base)
