work_category = VD4009,
social_security_taxpayer_ref_week = VD4012,
monthly_work_income = VD4017,
household_location = V1022)
}
data = clean_painel(painel)
data = unite(data, col = "year_quarter", year:quarter, sep = "_")
data = data %>%
mutate(sector_code = case_when(sector_code %in% c(1101, 1102,
1103, 1104,
1105, 1106,
1107, 1108, 1109,
1110, 1111, 1112,
1113, 1114, 1115,
1116, 1117, 1118, 1119,
1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209,
1401, 1402, 1500, 2000, 3001, 3002) ~ "Agricultura, Pecuaria, Producao Florestal e Pesca",
sector_code %in% c(5000, 6000,7001, 7002, 8001, 8002, 8009, 9000) ~ "Industrias Extrativas",
sector_code %in% c(10010, 10021, 10022, 10030, 10091, 10092, 10093, 10099,
11000, 12000, 13001, 13002, 14001, 14002, 15011, 15012, 15020,
16001, 16002, 17001, 17002, 18000, 19010, 19020, 19030,
20010, 20020, 20090, 21000, 22010, 22020,
23010, 23091, 23099, 24001, 24002, 24003,
25001, 25002, 26010, 26020, 26030, 26041, 26042,
27010, 27090, 28000, 29001, 29002, 29003, 30010, 30020, 30030, 300090,
31000,32001, 32002, 32003, 32009, 33001, 33002) ~ "Industrias de Transformacao",
sector_code %in% c(35010, 35021, 35022) ~ "Eletricidade e Gas",
sector_code %in% c(36000, 37000, 38000, 39000) ~ "Agua, Esgoto, Gestao de Residuos e Descontaminacao",
sector_code %in% c(41000, 42000, 43000) ~ "Construcao",
sector_code %in% c(45010, 45020, 45030, 45040) ~ "Comercio e Reparacao de Veiculos Automotores",
sector_code %in% c(49010, 4030, 49040, 49090, 50000, 51000, 52010, 52020, 53001, 53002) ~ "Transporte, Armazenagem e Correio",
sector_code %in% c(55000, 56011, 56012, 56020) ~ "Alojamento e Alimentacao",
sector_code %in% c(58000, 59000, 60001, 60002, 61000, 62000, 63000) ~ "Informacao e Comunicacao",
sector_code %in% c(64000, 65000, 66001, 66002) ~ "Atividades Financeiras e de Seguros",
sector_code == 68000 ~ "Atividades Imobiliarias",
sector_code %in% c(69000, 70000, 71000, 72000, 73010, 73020, 74000, 75000) ~ "Atividades Profissionais, Cientificas e T?cnicas",
sector_code %in% c(77010, 77020, 78000, 79000, 80000, 81011, 81012, 81020, 82001, 82002, 82003, 82009) ~ "Atividades Administrativas e Servicos Complementares",
sector_code %in% c(84011, 84012, 84013, 84014, 84015, 84016, 84017, 84020) ~ "Administracao Publica, Defesa e Seguridade Social",
sector_code %in% c(85011, 85012, 85013, 85014, 85021, 85029) ~ "Educacao",
sector_code %in% c(86001, 86002, 86003, 86004, 86009, 87000, 88000) ~ "Saude Humana e Servicos Sociais",
sector_code %in% c(90000, 91000, 92000, 93011, 93012, 93020) ~ "Artes, Cultura, Esportes e Recreacao",
sector_code %in% c(94010, 94020, 94091, 94099, 95010, 95030, 96010, 96020, 96030, 96090) ~ "Outras Atividades de Servicos",
sector_code == 97000 ~ "Servicos Domesticos",
sector_code == 99000 ~ "Organismos Internacionais",
sector_code == 0 ~ "Atividades Mal Definidas",
sector_code == 1999 ~ "Agropecuaria",
sector_code %in% c(48010, 48020, 48030, 48041, 48042, 48050, 48060,
48071, 48072, 48073, 48074, 48075, 48076, 48077, 48078,
48079, 48080, 48090, 48100) ~ "Comercio, exceto de Veiculos Automotores e Motocicletas"))
worker = data %>%
pivot_wider(id_cols = c(id_code),
names_from = year_quarter,
values_from = worker)
memory.limit(50000)
worker = data %>%
pivot_wider(id_cols = c(id_code),
names_from = year_quarter,
values_from = worker)
worker = worker %>%
filter(`2020_1` == 1)
variables = data %>%
select(id_code, race, gender, higher_educ_level, weights,
job_start, worker, year_quarter, household_location, job_function,
social_security_taxpayer, sector_code)
merge = left_join(worker, variables)
merge = merge %>%
mutate(unemployed = case_when(worker == 1 & social_security_taxpayer == 1 &
job_function == 6 ~ 0,
worker == 2 & social_security_taxpayer == 2 &
job_function  == 6 ~ 1)) %>%
filter(year_quarter %in% c("2020_1", "2020_2", "2020_3", "2020_4")) %>%
mutate(negro = case_when(race == 2 | race == 4 | race == 5 ~ 1,
race == 1 | race == 3 ~ 0))
View(data)
View(merge)
View(worker)
View(variables)
View(merge)
reg = lm_robust(unemployed ~ negro + as.factor(gender) +
as.factor(higher_educ_level) +
as.factor(job_start) + as.factor(year_quarter) +
as.factor(household_location) + as.factor(sector_code),
data = merge, weights = weights)
modelsummary(reg, stars = T)
View(merge)
table(merge$unemployed)
worker = data %>%
pivot_wider(id_cols = c(id_code),
names_from = year_quarter,
values_from = worker)
worker = worker %>%
filter(`2020_1` == 1)
variables = data %>%
select(id_code, race, gender, higher_educ_level, weights,
job_start, worker, year_quarter, household_location, job_function,
social_security_taxpayer, sector_code)
merge = left_join(worker, variables)
merge = merge %>%
mutate(unemployed = case_when(worker == 1 & social_security_taxpayer == 1 &
job_function == 6 ~ 0,
social_security_taxpayer == 2 &
job_function  == 6 ~ 1)) %>%
filter(year_quarter %in% c("2020_1", "2020_2", "2020_3", "2020_4")) %>%
mutate(negro = case_when(race == 2 | race == 4 | race == 5 ~ 1,
race == 1 | race == 3 ~ 0))
table(merge$unemployed)
reg = lm_robust(unemployed ~ negro + as.factor(gender) +
as.factor(higher_educ_level) +
as.factor(job_start) + as.factor(year_quarter) +
as.factor(household_location) + as.factor(sector_code),
data = merge, weights = weights)
t = merge %>% select(worker, social_security_taxpayer, job_function)
View(t)
modelsummary(reg, stars = T)
View(t)
t = t %>% filter(job_function == 6)
t = t %>%mutate(unemployed = case_when(worker == 1 & social_security_taxpayer == 1 &
job_function == 6 ~ 0,
social_security_taxpayer == 2 &
job_function  == 6 ~ 1)
t = t %>%
mutate(unemployed = case_when(worker == 1 & social_security_taxpayer == 1 & job_function == 6 ~ 0,
social_security_taxpayer == 2 &
job_function  == 6 ~ 1))
merge = merge %>%
mutate(unemployed = case_when(worker == 1 & social_security_taxpayer == 1 &
job_function == 6 ~ 0,
worker == 2 & social_security_taxpayer == 2 &
job_function  == 6 ~ 1)) %>%
filter(year_quarter %in% c("2020_1", "2020_2", "2020_3", "2020_4")) %>%
mutate(negro = case_when(race == 2 | race == 4 | race == 5 ~ 1,
race == 1 | race == 3 ~ 0))
reg = lm_robust(unemployed ~ negro + as.factor(gender) +
as.factor(higher_educ_level) +
as.factor(job_start) + as.factor(year_quarter) +
as.factor(household_location) + as.factor(sector_code),
data = merge, weights = weights)
modelsummary(reg, stars = T)
rm(t)
View(worker)
worker = data %>%
pivot_wider(id_cols = c(id_code),
names_from = year_quarter,
values_from = worker)
worker = worker %>%
filter(`2020_1` == 1)
variables = data %>%
select(id_code, race, gender, higher_educ_level, weights,
job_start, worker, year_quarter, household_location, job_function,
work_category, sector_code)
merge = left_join(worker, variables)
merge = merge %>%
mutate(unemployed = case_when(worker == 1 & work_category == 1 &
job_function == 3 ~ 0,
worker == 2 & work_category == 2 &
job_function  == 3 ~ 1)) %>%
filter(year_quarter %in% c("2020_1", "2020_2", "2020_3", "2020_4")) %>%
mutate(negro = case_when(race == 2 | race == 4 | race == 5 ~ 1,
race == 1 | race == 3 ~ 0))
reg = lm_robust(unemployed ~ negro + as.factor(gender) +
as.factor(higher_educ_level) +
as.factor(job_start) + as.factor(year_quarter) +
as.factor(household_location) + as.factor(sector_code),
data = merge, weights = weights)
modelsummary(reg, stars = T)
table(merge$unemployed)
worker = data %>%
pivot_wider(id_cols = c(id_code),
names_from = year_quarter,
values_from = worker)
worker = worker %>%
filter(`2020_1` == 1)
variables = data %>%
select(id_code, race, gender, higher_educ_level, weights,
job_start, worker, year_quarter, household_location, job_function,
work_category, sector_code, signed_work_card)
merge = left_join(worker, variables)
merge = merge %>%
mutate(unemployed = case_when(worker == 1 & work_category %in% c(5,7) &
job_function == 4 ~ 0,
worker == 2 & signed_work_card == 2 &
job_function  == 3 ~ 1)) %>%
filter(year_quarter %in% c("2020_1", "2020_2", "2020_3", "2020_4")) %>%
mutate(negro = case_when(race == 2 | race == 4 | race == 5 ~ 1,
race == 1 | race == 3 ~ 0))
modelsummary(reg, stars = T)
table(merge$unemployed)
merge = merge %>%
mutate(unemployed = case_when(worker == 1 & work_category %in% c(5,7) &
job_function == 4 ~ 0,
worker == 2 & signed_work_card == 2 &
job_function  == 4 ~ 1)) %>%
filter(year_quarter %in% c("2020_1", "2020_2", "2020_3", "2020_4")) %>%
mutate(negro = case_when(race == 2 | race == 4 | race == 5 ~ 1,
race == 1 | race == 3 ~ 0))
reg = lm_robust(unemployed ~ negro + as.factor(gender) +
as.factor(higher_educ_level) +
as.factor(job_start) + as.factor(year_quarter) +
as.factor(household_location) + as.factor(sector_code),
data = merge, weights = weights)
modelsummary(reg, stars = T)
matrizes = read.csv("./Transitions Matrices/transicoes_por_educ.csv")
matriz1 = matrizes %>%
filter(posicao_inicial == 1 &
posicao_final == 4) %>%
group_by(trim, educ) %>%
summarise(transition = sum(transition)) %>%
mutate(educ = as.character(educ))
graf_f_d = ggplot(matriz1, aes(x = trim, y = 100*transition,
color = educ, group = educ)) +
scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
"Completed Primary School and Incompleted High School",
"Completed High School and Incompleted College Degree",
"Completed College Degree"), values = carto_pal(name = "Vivid")) +
geom_line(size = 2) +
geom_point(size = 2) +
labs(x = "", y = "", title = "Formal to Unemployed (%)") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank()) +
scale_x_discrete(breaks = paste0(2012:2021, "_1"),
labels = 2012:2021)
library(rcartocolor)
graf_f_d = ggplot(matriz1, aes(x = trim, y = 100*transition,
color = educ, group = educ)) +
scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
"Completed Primary School and Incompleted High School",
"Completed High School and Incompleted College Degree",
"Completed College Degree"), values = carto_pal(name = "Vivid")) +
geom_line(size = 2) +
geom_point(size = 2) +
labs(x = "", y = "", title = "Formal to Unemployed (%)") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank()) +
scale_x_discrete(breaks = paste0(2012:2021, "_1"),
labels = 2012:2021)
graf_f_d
matriz2 = matrizes %>%
filter(posicao_inicial == 2 &
posicao_final == 4) %>%
group_by(trim, educ) %>%
summarise(transition = sum(transition)) %>%
mutate(educ = as.character(educ))
graf_i_d = ggplot(matriz2, aes(x = trim, y = 100*transition,
color = educ, group = educ)) +
scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
"Completed Primary School and Incompleted High School",
"Completed High School and Incompleted College Degree",
"Completed College Degree"), values = carto_pal(name = "Vivid")) +
geom_line(size = 2) +
geom_point(size = 2) +
labs(x = "", y = "", title = "Informal to Unemployed (%)") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank()) +
scale_x_discrete(breaks = paste0(2012:2021, "_1"),
labels = 2012:2021)
graf_i_d
matriz3 = matrizes %>%
filter(posicao_inicial == 1 &
posicao_final == 2) %>%
group_by(trim, educ) %>%
summarise(transition = sum(transition)) %>%
mutate(educ = as.character(educ))
graf_f_i = ggplot(matriz3, aes(x = trim, y = 100*transition,
color = educ, group = educ)) +
scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
"Completed Primary School and Incompleted High School",
"Completed High School and Incompleted College Degree",
"Completed College Degree"), values = carto_pal(name = "Vivid")) +
geom_line(size = 2) +
geom_point(size = 2) +
labs(x = "", y = "", title = "Formal to Informal (%)") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank()) +
scale_x_discrete(breaks = paste0(2012:2021, "_1"),
labels = 2012:2021)
graf_f_i
matriz4 = matrizes %>%
filter(posicao_inicial == 1 &
posicao_final == 3) %>%
group_by(trim, educ) %>%
summarise(transition = sum(transition)) %>%
mutate(educ = as.character(educ))
graf_f_inat = ggplot(matriz4, aes(x = trim, y = 100*transition,
color = educ, group = educ)) +
scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
"Completed Primary School and Incompleted High School",
"Completed High School and Incompleted College Degree",
"Completed College Degree"), values = carto_pal(name = "Vivid")) +
geom_line(size = 2) +
geom_point(size = 2) +
labs(x = "", y = "", title = "Formal to Inactive (%)") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank()) +
scale_x_discrete(breaks = paste0(2012:2021, "_1"),
labels = 2012:2021)
graf_f_inat
matriz5 = matrizes %>%
filter(posicao_inicial == 2 &
posicao_final == 3) %>%
group_by(trim, educ) %>%
summarise(transition = sum(transition)) %>%
mutate(educ = as.character(educ))
graf_i_inat = ggplot(matriz5, aes(x = trim, y = 100*transition,
color = educ, group = educ)) +
scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
"Completed Primary School and Incompleted High School",
"Completed High School and Incompleted College Degree",
"Completed College Degree"), values = carto_pal(name = "Vivid")) +
geom_line(size = 2) +
geom_point(size = 2) +
labs(x = "", y = "", title = "Informal to Inactive (%)") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank()) +
scale_x_discrete(breaks = paste0(2012:2021, "_1"),
labels = 2012:2021)
graf_i_inat
matrizes = read.csv("./Transitions Matrices/transicoes_por_educ.csv")
matriz1 = matrizes %>%
filter(posicao_inicial == 1 &
posicao_final == 4) %>%
group_by(trim, educ) %>%
summarise(transition = sum(transition)) %>%
mutate(educ = as.character(educ))
graf_f_d = ggplot(matriz1, aes(x = trim, y = 100*transition,
color = educ, group = educ)) +
scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
"Completed Primary School and Incompleted High School",
"Completed High School and Incompleted College Degree",
"Completed College Degree"), values = carto_pal(name = "Vivid")) +
geom_line(size = 2) +
geom_point(size = 2) +
labs(x = "", y = "", title = "Formal to Unemployed (%)") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank()) +
scale_x_discrete(breaks = paste0(2012:2021, "_1"),
labels = 2012:2021)
graf_f_d
matriz2 = matrizes %>%
filter(posicao_inicial == 2 &
posicao_final == 4) %>%
group_by(trim, educ) %>%
summarise(transition = sum(transition)) %>%
mutate(educ = as.character(educ))
graf_i_d = ggplot(matriz2, aes(x = trim, y = 100*transition,
color = educ, group = educ)) +
scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
"Completed Primary School and Incompleted High School",
"Completed High School and Incompleted College Degree",
"Completed College Degree"), values = carto_pal(name = "Vivid")) +
geom_line(size = 2) +
geom_point(size = 2) +
labs(x = "", y = "", title = "Informal to Unemployed (%)") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank()) +
scale_x_discrete(breaks = paste0(2012:2021, "_1"),
labels = 2012:2021)
graf_i_d
matriz3 = matrizes %>%
filter(posicao_inicial == 1 &
posicao_final == 2) %>%
group_by(trim, educ) %>%
summarise(transition = sum(transition)) %>%
mutate(educ = as.character(educ))
graf_f_i = ggplot(matriz3, aes(x = trim, y = 100*transition,
color = educ, group = educ)) +
scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
"Completed Primary School and Incompleted High School",
"Completed High School and Incompleted College Degree",
"Completed College Degree"), values = carto_pal(name = "Vivid")) +
geom_line(size = 2) +
geom_point(size = 2) +
labs(x = "", y = "", title = "Formal to Informal (%)") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank()) +
scale_x_discrete(breaks = paste0(2012:2021, "_1"),
labels = 2012:2021)
graf_f_i
matriz4 = matrizes %>%
filter(posicao_inicial == 1 &
posicao_final == 3) %>%
group_by(trim, educ) %>%
summarise(transition = sum(transition)) %>%
mutate(educ = as.character(educ))
graf_f_inat = ggplot(matriz4, aes(x = trim, y = 100*transition,
color = educ, group = educ)) +
scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
"Completed Primary School and Incompleted High School",
"Completed High School and Incompleted College Degree",
"Completed College Degree"), values = carto_pal(name = "Vivid")) +
geom_line(size = 2) +
geom_point(size = 2) +
labs(x = "", y = "", title = "Formal to Inactive (%)") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank()) +
scale_x_discrete(breaks = paste0(2012:2021, "_1"),
labels = 2012:2021)
graf_f_inat
matriz5 = matrizes %>%
filter(posicao_inicial == 2 &
posicao_final == 3) %>%
group_by(trim, educ) %>%
summarise(transition = sum(transition)) %>%
mutate(educ = as.character(educ))
graf_i_inat = ggplot(matriz5, aes(x = trim, y = 100*transition,
color = educ, group = educ)) +
scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
"Completed Primary School and Incompleted High School",
"Completed High School and Incompleted College Degree",
"Completed College Degree"), values = carto_pal(name = "Vivid")) +
geom_line(size = 2) +
geom_point(size = 2) +
labs(x = "", y = "", title = "Informal to Inactive (%)") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank()) +
scale_x_discrete(breaks = paste0(2012:2021, "_1"),
labels = 2012:2021)
graf_i_inat
matrizes = read.csv("./Transitions Matrices/transicoes_por_educ.csv")
matriz1 = matrizes %>%
filter(posicao_inicial == 1 &
posicao_final == 4) %>%
group_by(trim, educ) %>%
summarise(transition = sum(transition)) %>%
mutate(educ = as.character(educ))
graf_f_d = ggplot(matriz1, aes(x = trim, y = 100*transition,
color = educ, group = educ)) +
scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
"Completed Primary School and Incompleted High School",
"Completed High School and Incompleted College Degree",
"Completed College Degree"), values = carto_pal(name = "Vivid")) +
geom_line(size = 2) +
geom_point(size = 2) +
labs(x = "", y = "", title = "Formal to Unemployed (%)") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank()) +
scale_x_discrete(breaks = paste0(2012:2021, "_1"),
labels = 2012:2021)
graf_f_d
graf_f_d = ggplot(matriz1, aes(x = trim, y = 100*transition,
color = educ, group = educ)) +
scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
"Completed Primary School and Incompleted High School",
"Completed High School and Incompleted College Degree",
"Completed College Degree"), values = carto_pal(name = "Vivid")) +
geom_line(size = 2) +
geom_point(size = 2) +
labs(x = "", y = "", title = "Formal to Unemployed (%)") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
legend.position = "top") +
scale_x_discrete(breaks = paste0(2012:2021, "_1"),
labels = 2012:2021)
graf_f_d
graf_f_d = ggplot(matriz1, aes(x = trim, y = 100*transition,
color = educ, group = educ)) +
scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
"Completed Primary School and Incompleted High School",
"Completed High School and Incompleted College Degree",
"Completed College Degree"), values = carto_pal(name = "Vivid")) +
geom_line(size = 2) +
geom_point(size = 2) +
labs(x = "", y = "", title = "Formal to Unemployed (%)") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
legend.position = "top") +
scale_x_discrete(breaks = paste0(2012:2021, "_1"),
labels = 2012:2021)
graf_f_d
graf_f_d = ggplot(matriz1, aes(x = trim, y = 100*transition,
color = educ, group = educ)) +
scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
"Completed Primary School and Incompleted High School",
"Completed High School and Incompleted College Degree",
"Completed College Degree"), values = carto_pal(name = "Vivid")) +
geom_line(size = 2) +
geom_point(size = 2) +
labs(x = "", y = "", title = "Formal to Unemployed (%)") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank()) +
scale_x_discrete(breaks = paste0(2012:2021, "_1"),
labels = 2012:2021)
graf_f_d
