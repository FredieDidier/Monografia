geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y")
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Education Level of Self-Employed Non-Social Security Contributors in 2019") +
theme_minimal(base_size = 15) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Education Level of Self-Employed Social Security Contributors in 2019") +
theme_minimal(base_size = 15) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal(base_size = 15) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal(base_size = 15) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Social Security Contributors") +
theme_minimal(base_size = 15) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal(base_size = 15) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
ggsave("self_employed.png", path = "./output", width = 13.66,
height = 7.05)
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Social Security Contributors") +
theme_minimal(base_size = 18) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal(base_size = 18) +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
ggsave("self_employed.png", path = "./output", width = 13.66,
height = 7.05)
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.title = element_text(size = 15),
legend.text = element_text(size = 15)) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.text = element_text(size = 15)) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),,
legend.text = element_text(size = 15)) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.text = element_text(size = 15)) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
warnings()
font_import(path = "C:/Users/Fredie/AppData/Local/Microsoft/Windows/Fonts")
loadfonts(device = "win")
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.text = element_text(size = 15)) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.text = element_text(size = 15)) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.text = element_text(size = 20)) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.text = element_text(size = 20)) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=2,byrow=TRUE))
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
grafico1 = ggplot(trab_conta_propria_n_INSS, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Non-Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.text = element_text(size = 20)) +
geom_label(aes(x = 1.2, label = paste0(labell, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=4,byrow=TRUE))
graf_1 = ggplot(trab_conta_propria_INSS, aes(x = "", y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat="identity") +
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incomplete Primary School",
"Complete Primary School and Incomplete High School",
"Complete High School and Incomplete College Degree",
"Complete College Degree")) +
labs(x = "", y = "",
title = "Self-Employed Social Security Contributors") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank(),
legend.text = element_text(size = 20)) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y") +
guides(fill=guide_legend(nrow=4,byrow=TRUE))
############ Trabalhadores Conta Propria Contribuintes/Noo Contribuintes INSS 2019 #######
ggarrange(graf_1, grafico1,
common.legend = TRUE,
legend = "bottom")
ggsave("self_employed.png", path = "./output", width = 13.66,
height = 7.05)
rm(list = ls())
library(tidyverse)
library(extrafont)
library(modelsummary)
library(estimatr)
library(rcartocolor)
library(grid)
library(gridExtra)
library(Hmisc)
trimestres <- c("2012_1", "2012_2", "2012_3", "2012_4",
"2013_1", "2013_2", "2013_3", "2013_4",
"2014_1", "2014_2", "2014_3", "2014_4",
"2015_1", "2015_2", "2015_3", "2015_4",
"2016_1", "2016_2", "2016_3", "2016_4",
"2017_1", "2017_2", "2017_3", "2017_4",
"2018_1", "2018_2", "2018_3", "2018_4",
"2019_1", "2019_2", "2019_3", "2019_4",
"2020_1", "2020_2", "2020_3", "2020_4",
"2021_1", "2021_2", "2021_3")
trimestres <- rep(trimestres, 4)
next_trimestres <- c("2012_2", "2012_3", "2012_4",
"2013_1", "2013_2", "2013_3", "2013_4",
"2014_1", "2014_2", "2014_3", "2014_4",
"2015_1", "2015_2", "2015_3", "2015_4",
"2016_1", "2016_2", "2016_3", "2016_4",
"2017_1", "2017_2", "2017_3", "2017_4",
"2018_1", "2018_2", "2018_3", "2018_4",
"2019_1", "2019_2", "2019_3", "2019_4",
"2020_1", "2020_2", "2020_3", "2020_4",
"2021_1", "2021_2", "2021_3", "2021_4")
next_trimestres <- rep(next_trimestres, 4)
educ <- c(
rep(1, 39),
rep(2, 39),
rep(3, 39),
rep(4, 39)
)
source("./analysis/_transition_matrix_function.R")
matrizes <- pmap_dfr(
list(trimestres, next_trimestres, educ),
purrr::insistently(function(trim, next_trim, educ){
message(paste0("Transition ", trim, " to ", next_trim, "\n educ ", educ))
df <- readr::read_rds(
paste0("input/painel_",
trim,
"_",
educ,
".rds")
)
mat <- cria_matriz_transicao(df, trim, next_trim, 10, prop = FALSE)
colnames(mat) <- 1:10
mat <- as_tibble(mat)
mat$posicao_inicial <- 1:10
mat <- mat %>%
pivot_longer(-posicao_inicial,
names_to = "posicao_final",
values_to = "transition")
mat$educ <- educ
mat$trim <- trim
mat <- mat %>%
relocate(trim, educ, posicao_inicial, posicao_final)
}, quiet = FALSE)
)
memory.limit(50000)
matrizes <- pmap_dfr(
list(trimestres, next_trimestres, educ),
purrr::insistently(function(trim, next_trim, educ){
message(paste0("Transition ", trim, " to ", next_trim, "\n educ ", educ))
df <- readr::read_rds(
paste0("input/painel_",
trim,
"_",
educ,
".rds")
)
mat <- cria_matriz_transicao(df, trim, next_trim, 10, prop = FALSE)
colnames(mat) <- 1:10
mat <- as_tibble(mat)
mat$posicao_inicial <- 1:10
mat <- mat %>%
pivot_longer(-posicao_inicial,
names_to = "posicao_final",
values_to = "transition")
mat$educ <- educ
mat$trim <- trim
mat <- mat %>%
relocate(trim, educ, posicao_inicial, posicao_final)
}, quiet = FALSE)
)
matrizes = read.csv("./input/transicoes_por_educ_10_x_10.csv")
View(matrizes)
matrizes = matrizes %>%
filter(trim %in% c("2019_1", "2019_2", "2019_3", "2019_4"))
