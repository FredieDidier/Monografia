nuevo_grafico = ggplot(empreg_formal, aes(x = year_quarter, y = labelll,
fill = factor(higher_educ_level))) +
geom_bar(stat = "identity")+
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism"),
labels = c("Uneducated and Incompleted Primary School",
"Completed Primary School and Incompleted High School",
"Completed High School and Incompleted College Degree",
"Completed College Degree")) +
labs(x = "", y = "",
title = "Education Level of Formal Employers in 2019") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(x = 1.2, label = paste0(labelll, "%")), position = position_stack(vjust = 0.5),
show.legend = F)+
coord_polar("y")
ggarrange(nuevo_grafico, nueva_grafico,
common.legend = T,
legend = "bottom")
ggsave("employers.png", path = "./output", width = 13.66,
height = 7.05)
df = read_rds("./input/painel_2019.rds")
sal_ocup = df %>%
filter(worker == 1) %>%
select(worker, monthly_work_income, job_function, higher_educ_level,
year_quarter) %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incomplete",
higher_educ_level %in% c(3) ~ "Primary School Complete",
higher_educ_level %in% c(4) ~ "High School Incomplete",
higher_educ_level %in% c(5) ~ "High School Complete",
higher_educ_level %in% c(6) ~ "College Degree Incomplete",
higher_educ_level %in% c(7) ~ "College Degree Complete"))  %>%
group_by(higher_educ_level) %>% mutate(labels = n()) %>%
mutate(labell = round(labels/nrow(.), digits = 2))
sal_ocup$labell = sal_ocup$labell * 100
sal_ocup = sal_ocup %>%
select(year_quarter, higher_educ_label, monthly_work_income, higher_educ_level, labell) %>%
mutate(media = mean(monthly_work_income, na.rm = T)) %>%
mutate(media = round(media, digits = 2)) %>%
distinct() %>%
mutate(labelll = case_when(higher_educ_label == "Uneducated" & year_quarter == "2019_1" ~ 830.65,
higher_educ_label == "Primary School Incomplete" & year_quarter == "2019_1" ~ 1185.57,
higher_educ_label == "Primary School Complete" & year_quarter == "2019_1" ~ 1319.31,
higher_educ_label == "High School Incomplete" & year_quarter == "2019_1" ~ 1463.82,
higher_educ_label == "High School Complete" & year_quarter == "2019_1" ~ 1755.71,
higher_educ_label == "College Degree Incomplete" & year_quarter == "2019_1" ~ 2140.51,
higher_educ_label == "College Degree Complete" & year_quarter == "2019_1" ~ 4609.40)) %>%
filter(!is.na(labelll)) %>%
select(higher_educ_level, higher_educ_label, labelll) %>%
distinct()
grafico_sal = ggplot(sal_ocup, aes(x = higher_educ_level, y = labelll,
fill = higher_educ_label)) +
geom_bar(stat = "identity")+
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism")) +
labs(x = "", y = "",
title = "Average Monthly Labor Earnings by Education Level in 2019") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 15, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(label = paste0("R$",labelll)), position = position_dodge(width = 0.9), vjust = -0.25,
show.legend = F)
grafico_sal
ggsave("salario_educ.png", path = "./output", width = 13.66,
height = 7.05)
sal_ocup = df %>%
filter(worker == 1) %>%
select(worker, monthly_work_income, job_function, higher_educ_level,
year_quarter) %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incomplete",
higher_educ_level %in% c(3) ~ "Primary School Complete",
higher_educ_level %in% c(4) ~ "High School Incomplete",
higher_educ_level %in% c(5) ~ "High School Complete",
higher_educ_level %in% c(6) ~ "College Degree Incomplete",
higher_educ_level %in% c(7) ~ "College Degree Complete"))  %>%
group_by(higher_educ_level)  mutate(labels = sum(weights)) %>%
ungroup() %>%
mutate(labell = round(labels/sum(weights), digits = 2))
sal_ocup = df %>%
filter(worker == 1) %>%
select(worker, monthly_work_income, job_function, higher_educ_level,
year_quarter, weights) %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incomplete",
higher_educ_level %in% c(3) ~ "Primary School Complete",
higher_educ_level %in% c(4) ~ "High School Incomplete",
higher_educ_level %in% c(5) ~ "High School Complete",
higher_educ_level %in% c(6) ~ "College Degree Incomplete",
higher_educ_level %in% c(7) ~ "College Degree Complete"))  %>%
group_by(higher_educ_level)  mutate(labels = sum(weights)) %>%
ungroup() %>%
mutate(labell = round(labels/sum(weights), digits = 2))
sal_ocup = df %>%
filter(worker == 1) %>%
select(worker, monthly_work_income, job_function, higher_educ_level,
year_quarter, weights) %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incomplete",
higher_educ_level %in% c(3) ~ "Primary School Complete",
higher_educ_level %in% c(4) ~ "High School Incomplete",
higher_educ_level %in% c(5) ~ "High School Complete",
higher_educ_level %in% c(6) ~ "College Degree Incomplete",
higher_educ_level %in% c(7) ~ "College Degree Complete"))  %>%
group_by(higher_educ_level) %>% mutate(labels = sum(weights)) %>%
ungroup() %>%
mutate(labell = round(labels/sum(weights), digits = 2))
sal_ocup$labell = sal_ocup$labell * 100
sal_ocup = sal_ocup %>%
select(year_quarter, higher_educ_label, monthly_work_income, higher_educ_level, labell) %>%
mutate(media = mean(monthly_work_income, na.rm = T)) %>%
mutate(media = round(media, digits = 2)) %>%
distinct() %>%
mutate(labelll = case_when(higher_educ_label == "Uneducated" & year_quarter == "2019_1" ~ 830.65,
higher_educ_label == "Primary School Incomplete" & year_quarter == "2019_1" ~ 1185.57,
higher_educ_label == "Primary School Complete" & year_quarter == "2019_1" ~ 1319.31,
higher_educ_label == "High School Incomplete" & year_quarter == "2019_1" ~ 1463.82,
higher_educ_label == "High School Complete" & year_quarter == "2019_1" ~ 1755.71,
higher_educ_label == "College Degree Incomplete" & year_quarter == "2019_1" ~ 2140.51,
higher_educ_label == "College Degree Complete" & year_quarter == "2019_1" ~ 4609.40)) %>%
filter(!is.na(labelll)) %>%
select(higher_educ_level, higher_educ_label, labelll) %>%
distinct()
grafico_sal = ggplot(sal_ocup, aes(x = higher_educ_level, y = labelll,
fill = higher_educ_label)) +
geom_bar(stat = "identity")+
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism")) +
labs(x = "", y = "",
title = "Average Monthly Labor Earnings by Education Level in 2019") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 15, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(label = paste0("R$",labelll)), position = position_dodge(width = 0.9), vjust = -0.25,
show.legend = F)
grafico_sal
wtd_mean
?wtd_mean
library(Hmisc)
sal_ocup = sal_ocup %>%
select(year_quarter, higher_educ_label, monthly_work_income, higher_educ_level, labell) %>%
mutate(media = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(media = round(media, digits = 2)) %>%
distinct() %>%
mutate(labelll = case_when(higher_educ_label == "Uneducated" & year_quarter == "2019_1" ~ 830.65,
higher_educ_label == "Primary School Incomplete" & year_quarter == "2019_1" ~ 1185.57,
higher_educ_label == "Primary School Complete" & year_quarter == "2019_1" ~ 1319.31,
higher_educ_label == "High School Incomplete" & year_quarter == "2019_1" ~ 1463.82,
higher_educ_label == "High School Complete" & year_quarter == "2019_1" ~ 1755.71,
higher_educ_label == "College Degree Incomplete" & year_quarter == "2019_1" ~ 2140.51,
higher_educ_label == "College Degree Complete" & year_quarter == "2019_1" ~ 4609.40)) %>%
filter(!is.na(labelll)) %>%
select(higher_educ_level, higher_educ_label, labelll) %>%
distinct()
df = read_rds("./input/painel_2019.rds")
sal_ocup = df %>%
filter(worker == 1) %>%
select(worker, monthly_work_income, job_function, higher_educ_level,
year_quarter, weights) %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incomplete",
higher_educ_level %in% c(3) ~ "Primary School Complete",
higher_educ_level %in% c(4) ~ "High School Incomplete",
higher_educ_level %in% c(5) ~ "High School Complete",
higher_educ_level %in% c(6) ~ "College Degree Incomplete",
higher_educ_level %in% c(7) ~ "College Degree Complete"))  %>%
group_by(higher_educ_level) %>% mutate(labels = sum(weights)) %>%
ungroup() %>%
mutate(labell = round(labels/sum(weights), digits = 2))
sal_ocup$labell = sal_ocup$labell * 100
sal_ocup = sal_ocup %>%
select(year_quarter, higher_educ_label, monthly_work_income, higher_educ_level, labell) %>%
mutate(media = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(media = round(media, digits = 2)) %>%
distinct() %>%
mutate(labelll = case_when(higher_educ_label == "Uneducated" & year_quarter == "2019_1" ~ 830.65,
higher_educ_label == "Primary School Incomplete" & year_quarter == "2019_1" ~ 1185.57,
higher_educ_label == "Primary School Complete" & year_quarter == "2019_1" ~ 1319.31,
higher_educ_label == "High School Incomplete" & year_quarter == "2019_1" ~ 1463.82,
higher_educ_label == "High School Complete" & year_quarter == "2019_1" ~ 1755.71,
higher_educ_label == "College Degree Incomplete" & year_quarter == "2019_1" ~ 2140.51,
higher_educ_label == "College Degree Complete" & year_quarter == "2019_1" ~ 4609.40)) %>%
filter(!is.na(labelll)) %>%
select(higher_educ_level, higher_educ_label, labelll) %>%
distinct()
df = read_rds("./input/painel_2019.rds")
sal_ocup = df %>%
filter(worker == 1) %>%
select(worker, monthly_work_income, job_function, higher_educ_level,
year_quarter, weights) %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incomplete",
higher_educ_level %in% c(3) ~ "Primary School Complete",
higher_educ_level %in% c(4) ~ "High School Incomplete",
higher_educ_level %in% c(5) ~ "High School Complete",
higher_educ_level %in% c(6) ~ "College Degree Incomplete",
higher_educ_level %in% c(7) ~ "College Degree Complete"))  %>%
group_by(higher_educ_level) %>% mutate(labels = sum(weights)) %>%
ungroup() %>%
mutate(labell = round(labels/sum(weights), digits = 2))
sal_ocup$labell = sal_ocup$labell * 100
sal_ocup = sal_ocup %>%
select(year_quarter, higher_educ_label, monthly_work_income, higher_educ_level, labell) %>%
filter(!is.na(monthly_work_income)) %>%
mutate(media = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(media = round(media, digits = 2)) %>%
distinct() %>%
mutate(labelll = case_when(higher_educ_label == "Uneducated" & year_quarter == "2019_1" ~ 830.65,
higher_educ_label == "Primary School Incomplete" & year_quarter == "2019_1" ~ 1185.57,
higher_educ_label == "Primary School Complete" & year_quarter == "2019_1" ~ 1319.31,
higher_educ_label == "High School Incomplete" & year_quarter == "2019_1" ~ 1463.82,
higher_educ_label == "High School Complete" & year_quarter == "2019_1" ~ 1755.71,
higher_educ_label == "College Degree Incomplete" & year_quarter == "2019_1" ~ 2140.51,
higher_educ_label == "College Degree Complete" & year_quarter == "2019_1" ~ 4609.40)) %>%
filter(!is.na(labelll)) %>%
select(higher_educ_level, higher_educ_label, labelll) %>%
distinct()
sal_ocup
sal_ocup = sal_ocup %>%
select(year_quarter, higher_educ_label, monthly_work_income, higher_educ_level, labell, weights) %>%
filter(!is.na(monthly_work_income)) %>%
mutate(media = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(media = round(media, digits = 2)) %>%
distinct() %>%
mutate(labelll = case_when(higher_educ_label == "Uneducated" & year_quarter == "2019_1" ~ 830.65,
higher_educ_label == "Primary School Incomplete" & year_quarter == "2019_1" ~ 1185.57,
higher_educ_label == "Primary School Complete" & year_quarter == "2019_1" ~ 1319.31,
higher_educ_label == "High School Incomplete" & year_quarter == "2019_1" ~ 1463.82,
higher_educ_label == "High School Complete" & year_quarter == "2019_1" ~ 1755.71,
higher_educ_label == "College Degree Incomplete" & year_quarter == "2019_1" ~ 2140.51,
higher_educ_label == "College Degree Complete" & year_quarter == "2019_1" ~ 4609.40)) %>%
filter(!is.na(labelll)) %>%
select(higher_educ_level, higher_educ_label, labelll) %>%
distinct()
grafico_sal = ggplot(sal_ocup, aes(x = higher_educ_level, y = labelll,
fill = higher_educ_label)) +
geom_bar(stat = "identity")+
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism")) +
labs(x = "", y = "",
title = "Average Monthly Labor Earnings by Education Level in 2019") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 15, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(label = paste0("R$",labelll)), position = position_dodge(width = 0.9), vjust = -0.25,
show.legend = F)
grafico_sal
View(sal_ocup)
df = read_rds("./input/painel_2019.rds")
sal_ocup = df %>%
filter(worker == 1) %>%
select(worker, monthly_work_income, job_function, higher_educ_level,
year_quarter, weights) %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incomplete",
higher_educ_level %in% c(3) ~ "Primary School Complete",
higher_educ_level %in% c(4) ~ "High School Incomplete",
higher_educ_level %in% c(5) ~ "High School Complete",
higher_educ_level %in% c(6) ~ "College Degree Incomplete",
higher_educ_level %in% c(7) ~ "College Degree Complete"))  %>%
group_by(higher_educ_level) %>% mutate(labels = sum(weights)) %>%
ungroup() %>%
mutate(labell = round(labels/sum(weights), digits = 2))
sal_ocup$labell = sal_ocup$labell * 100
sal_ocup = sal_ocup %>%
select(year_quarter, higher_educ_label, monthly_work_income, higher_educ_level, labell, weights) %>%
filter(!is.na(monthly_work_income)) %>%
mutate(media = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(media = round(media, digits = 2))
View(sal_ocup)
df = read_rds("./input/painel_2019.rds")
sal_ocup = df %>%
filter(worker == 1) %>%
select(worker, monthly_work_income, job_function, higher_educ_level,
year_quarter, weights) %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incomplete",
higher_educ_level %in% c(3) ~ "Primary School Complete",
higher_educ_level %in% c(4) ~ "High School Incomplete",
higher_educ_level %in% c(5) ~ "High School Complete",
higher_educ_level %in% c(6) ~ "College Degree Incomplete",
higher_educ_level %in% c(7) ~ "College Degree Complete"))  %>%
group_by(higher_educ_level) %>% mutate(labels = sum(weights)) %>%
ungroup() %>%
mutate(labell = round(labels/sum(weights), digits = 2))
sal_ocup$labell = sal_ocup$labell * 100
sal_ocup = sal_ocup %>%
select(year_quarter, higher_educ_label, monthly_work_income, higher_educ_level, labell, weights) %>%
filter(!is.na(monthly_work_income)) %>%
mutate(media = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(media = round(media, digits = 2)) %>%
distinct()
sal_ocup = df %>%
filter(worker == 1) %>%
select(worker, monthly_work_income, job_function, higher_educ_level,
year_quarter, weights) %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incomplete",
higher_educ_level %in% c(3) ~ "Primary School Complete",
higher_educ_level %in% c(4) ~ "High School Incomplete",
higher_educ_level %in% c(5) ~ "High School Complete",
higher_educ_level %in% c(6) ~ "College Degree Incomplete",
higher_educ_level %in% c(7) ~ "College Degree Complete"))  %>%
group_by(higher_educ_level) %>% mutate(labels = sum(weights)) %>%
ungroup() %>%
mutate(labell = round(labels/sum(weights), digits = 2))
sal_ocup$labell = sal_ocup$labell * 100
sal_ocup = sal_ocup %>%
select(year_quarter, higher_educ_label, monthly_work_income, higher_educ_level, labell, weights) %>%
filter(!is.na(monthly_work_income)) %>%
group_by(labell) %>%
mutate(media = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(media = round(media, digits = 2)) %>%
distinct()
sal_ocup = df %>%
filter(worker == 1) %>%
select(worker, monthly_work_income, job_function, higher_educ_level,
year_quarter, weights) %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incomplete",
higher_educ_level %in% c(3) ~ "Primary School Complete",
higher_educ_level %in% c(4) ~ "High School Incomplete",
higher_educ_level %in% c(5) ~ "High School Complete",
higher_educ_level %in% c(6) ~ "College Degree Incomplete",
higher_educ_level %in% c(7) ~ "College Degree Complete"))  %>%
group_by(higher_educ_level) %>% mutate(labels = sum(weights)) %>%
ungroup() %>%
mutate(labell = round(labels/sum(weights), digits = 2))
sal_ocup$labell = sal_ocup$labell * 100
sal_ocup = sal_ocup %>%
select(year_quarter, higher_educ_label, monthly_work_income, higher_educ_level, labell, weights) %>%
filter(!is.na(monthly_work_income)) %>%
group_by(labels) %>%
mutate(media = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(media = round(media, digits = 2)) %>%
distinct()
sal_ocup = sal_ocup %>%
select(year_quarter, higher_educ_label, monthly_work_income, higher_educ_level, labell, weights,
labels) %>%
filter(!is.na(monthly_work_income)) %>%
group_by(labels) %>%
mutate(media = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(media = round(media, digits = 2)) %>%
distinct()
table(sal_ocup$media)
sal_ocup = df %>%
filter(worker == 1) %>%
select(worker, monthly_work_income, job_function, higher_educ_level,
year_quarter, weights) %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incomplete",
higher_educ_level %in% c(3) ~ "Primary School Complete",
higher_educ_level %in% c(4) ~ "High School Incomplete",
higher_educ_level %in% c(5) ~ "High School Complete",
higher_educ_level %in% c(6) ~ "College Degree Incomplete",
higher_educ_level %in% c(7) ~ "College Degree Complete"))  %>%
group_by(higher_educ_level) %>% mutate(labels = sum(weights)) %>%
ungroup() %>%
mutate(labell = round(labels/sum(weights), digits = 2))
sal_ocup$labell = sal_ocup$labell * 100
sal_ocup = sal_ocup %>%
select(year_quarter, higher_educ_label, monthly_work_income, higher_educ_level, labell, weights,
labels) %>%
filter(!is.na(monthly_work_income)) %>%
group_by(labels) %>%
mutate(media = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(media = round(media, digits = 2)) %>%
distinct() %>%
mutate(labelll = case_when(higher_educ_label == "Uneducated" & year_quarter == "2019_1" ~ 931.37,
higher_educ_label == "Primary School Incomplete" & year_quarter == "2019_1" ~ 1245.76,
higher_educ_label == "Primary School Complete" & year_quarter == "2019_1" ~ 1378.01,
higher_educ_label == "High School Incomplete" & year_quarter == "2019_1" ~ 1509.52,
higher_educ_label == "High School Complete" & year_quarter == "2019_1" ~ 1819.98,
higher_educ_label == "College Degree Incomplete" & year_quarter == "2019_1" ~ 2250.92,
higher_educ_label == "College Degree Complete" & year_quarter == "2019_1" ~ 5039.78)) %>%
filter(!is.na(labelll)) %>%
select(higher_educ_level, higher_educ_label, labelll) %>%
distinct()
sal_ocup = df %>%
filter(worker == 1) %>%
select(worker, monthly_work_income, job_function, higher_educ_level,
year_quarter, weights) %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incomplete",
higher_educ_level %in% c(3) ~ "Primary School Complete",
higher_educ_level %in% c(4) ~ "High School Incomplete",
higher_educ_level %in% c(5) ~ "High School Complete",
higher_educ_level %in% c(6) ~ "College Degree Incomplete",
higher_educ_level %in% c(7) ~ "College Degree Complete"))  %>%
group_by(higher_educ_level) %>% mutate(labels = sum(weights)) %>%
ungroup() %>%
mutate(labell = round(labels/sum(weights), digits = 2))
sal_ocup$labell = sal_ocup$labell * 100
sal_ocup = df %>%
filter(worker == 1) %>%
select(worker, monthly_work_income, job_function, higher_educ_level,
year_quarter, weights) %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incomplete",
higher_educ_level %in% c(3) ~ "Primary School Complete",
higher_educ_level %in% c(4) ~ "High School Incomplete",
higher_educ_level %in% c(5) ~ "High School Complete",
higher_educ_level %in% c(6) ~ "College Degree Incomplete",
higher_educ_level %in% c(7) ~ "College Degree Complete"))  %>%
group_by(higher_educ_level) %>% mutate(labels = sum(weights)) %>%
ungroup()
filter(worker == 1) %>%
select(worker, monthly_work_income, job_function, higher_educ_level,
year_quarter, weights) %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incomplete",
higher_educ_level %in% c(3) ~ "Primary School Complete",
higher_educ_level %in% c(4) ~ "High School Incomplete",
higher_educ_level %in% c(5) ~ "High School Complete",
higher_educ_level %in% c(6) ~ "College Degree Incomplete",
higher_educ_level %in% c(7) ~ "College Degree Complete"))  %>%
group_by(higher_educ_level) %>% mutate(labels = sum(weights)) %>%
ungroup() %>%
mutate(labell = round(labels/sum(weights), digits = 2))
sal_ocup = df %>%
filter(worker == 1) %>%
select(worker, monthly_work_income, job_function, higher_educ_level,
year_quarter, weights) %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incomplete",
higher_educ_level %in% c(3) ~ "Primary School Complete",
higher_educ_level %in% c(4) ~ "High School Incomplete",
higher_educ_level %in% c(5) ~ "High School Complete",
higher_educ_level %in% c(6) ~ "College Degree Incomplete",
higher_educ_level %in% c(7) ~ "College Degree Complete"))  %>%
group_by(higher_educ_level) %>% mutate(labels = sum(weights)) %>%
ungroup() %>%
mutate(labell = round(labels/sum(weights), digits = 2))
sal_ocup$labell = sal_ocup$labell * 100
sal_ocup = sal_ocup %>%
select(year_quarter, higher_educ_label, monthly_work_income, higher_educ_level, labell, weights,
labels) %>%
filter(!is.na(monthly_work_income)) %>%
group_by(labels) %>%
mutate(media = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(media = round(media, digits = 2)) %>%
distinct() %>%
mutate(labelll = case_when(higher_educ_label == "Uneducated" & year_quarter == "2019_1" ~ 931.37,
higher_educ_label == "Primary School Incomplete" & year_quarter == "2019_1" ~ 1245.76,
higher_educ_label == "Primary School Complete" & year_quarter == "2019_1" ~ 1378.01,
higher_educ_label == "High School Incomplete" & year_quarter == "2019_1" ~ 1509.52,
higher_educ_label == "High School Complete" & year_quarter == "2019_1" ~ 1819.98,
higher_educ_label == "College Degree Incomplete" & year_quarter == "2019_1" ~ 2250.92,
higher_educ_label == "College Degree Complete" & year_quarter == "2019_1" ~ 5039.78)) %>%
filter(!is.na(labelll)) %>%
select(higher_educ_level, higher_educ_label, labelll) %>%
distinct()
grafico_sal = ggplot(sal_ocup, aes(x = higher_educ_level, y = labelll,
fill = higher_educ_label)) +
geom_bar(stat = "identity")+
scale_fill_manual(name = "Education Level",
values = carto_pal(name = "Prism")) +
labs(x = "", y = "",
title = "Average Monthly Labor Earnings by Education Level in 2019") +
theme_minimal() +
theme(text = element_text(family = "LM Roman 10"),
plot.title = element_text(size = 15, face = "bold", hjust = 0.5),
legend.title = element_blank(),
axis.text = element_blank()) +
geom_label(aes(label = paste0("R$",labelll)), position = position_dodge(width = 0.9), vjust = -0.25,
show.legend = F)
grafico_sal
sal_ocup = df %>%
filter(worker == 1) %>%
select(worker, monthly_work_income, job_function, higher_educ_level,
year_quarter, weights) %>%
mutate(higher_educ_label = case_when(higher_educ_level %in% c(1) ~"Uneducated",
higher_educ_level %in% c(2) ~ "Primary School Incomplete",
higher_educ_level %in% c(3) ~ "Primary School Complete",
higher_educ_level %in% c(4) ~ "High School Incomplete",
higher_educ_level %in% c(5) ~ "High School Complete",
higher_educ_level %in% c(6) ~ "College Degree Incomplete",
higher_educ_level %in% c(7) ~ "College Degree Complete"))  %>%
group_by(higher_educ_level) %>% mutate(labels = sum(weights)) %>%
ungroup() %>%
mutate(labell = round(labels/sum(weights), digits = 2))
sal_ocup$labell = sal_ocup$labell * 100
sal_ocup = sal_ocup %>%
select(year_quarter, higher_educ_label, monthly_work_income, higher_educ_level, labell, weights,
labels) %>%
filter(!is.na(monthly_work_income)) %>%
group_by(labels) %>%
mutate(media = wtd.mean(monthly_work_income, weights = weights)) %>%
mutate(media = round(media, digits = 2)) %>%
distinct() %>%
mutate(labelll = case_when(higher_educ_label == "Uneducated" & year_quarter == "2019_1" ~ 931.37,
higher_educ_label == "Primary School Incomplete" & year_quarter == "2019_1" ~ 1245.76,
higher_educ_label == "Primary School Complete" & year_quarter == "2019_1" ~ 1378.01,
higher_educ_label == "High School Incomplete" & year_quarter == "2019_1" ~ 1509.52,
higher_educ_label == "High School Complete" & year_quarter == "2019_1" ~ 1819.98,
higher_educ_label == "College Degree Incomplete" & year_quarter == "2019_1" ~ 2250.92,
higher_educ_label == "College Degree Complete" & year_quarter == "2019_1" ~ 5039.78)) %>%
filter(!is.na(labelll)) %>%
select(higher_educ_level, higher_educ_label, labelll) %>%
distinct()
ggsave("salario_educ.png", path = "./output", width = 13.66,
height = 7.05)
