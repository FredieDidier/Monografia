library(extrafont)

font_import(path = "C:/Users/Fredie/AppData/Local/Microsoft/Windows/Fonts")
y
loadfonts(device = "win")

library(ggsci)
library(RColorBrewer)
library(ghibli)
library(dichromat)
library(rcartocolor)
library(grid)
library(gridExtra)

 ## GrÃ¡fico Matrizes
 
 matrizes = read.csv("./input/transicoes_por_educ.csv")
 
 ## Formal - Desempregado
 
 matriz_formal_desempregado = matrizes %>%
   filter(posicao_inicial == 1 &
            posicao_final == 4) %>%
   mutate(educ = as.character(educ))
 
 graf_f_d = ggplot(matriz_formal_desempregado, aes(x = trim, y = 100*transition, 
                                color = educ, group = educ)) +
   scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
                                 "Completed Primary School and Incompleted High School",
                                 "Completed High School and Incompleted College Degree",
                                 "Completed College Degree"), values = carto_pal(name = "Vivid")) +
   geom_line(size = 2) +
   geom_point(size = 2) +
   labs(x = "", y = "", title = "Formal to Unemployed (%)") +
   theme_minimal() +
   theme(text = element_text(family = "LM Roman 10"),
         plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
         legend.title = element_blank()) +
   scale_x_discrete(breaks = paste0(2012:2021, "_1"),
                    labels = 2012:2021) 
 
 
 ## Informal - Desempregado
 
 matriz_informal_desempregado = matrizes %>%
   filter(posicao_inicial == 2 &
            posicao_final == 4) %>%
   mutate(educ = as.character(educ))
 
 graf_i_d = ggplot(matriz_informal_desempregado, aes(x = trim, y = 100*transition, 
                                color = educ, group = educ)) +
   scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
                                 "Completed Primary School and Incompleted High School",
                                 "Completed High School and Incompleted College Degree",
                                 "Completed College Degree"), values = carto_pal(name = "Vivid")) +
   geom_line(size = 2) +
   geom_point(size = 2) +
   labs(x = "", y = "", title = "Informal to Unemployed (%)") +
   theme_minimal() +
   theme(text = element_text(family = "LM Roman 10"),
         plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
         legend.title = element_blank()) +
   scale_x_discrete(breaks = paste0(2012:2021, "_1"),
                    labels = 2012:2021)
 
 
 
 ## Formal - Informal
 
 matriz_formal_informal = matrizes %>%
   filter(posicao_inicial == 1 &
            posicao_final == 2) %>%
   mutate(educ = as.character(educ))
 
 graf_f_i = ggplot(matriz_formal_informal, aes(x = trim, y = 100*transition, 
                                color = educ, group = educ)) +
   scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
                                 "Completed Primary School and Incompleted High School",
                                 "Completed High School and Incompleted College Degree",
                                 "Completed College Degree"), values = carto_pal(name = "Vivid")) +
   geom_line(size = 2) +
   geom_point(size = 2) +
   labs(x = "", y = "", title = "Formal to Informal (%)") +
   theme_minimal() +
   theme(text = element_text(family = "LM Roman 10"),
         plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
         legend.title = element_blank()) +
   scale_x_discrete(breaks = paste0(2012:2021, "_1"),
                    labels = 2012:2021)
 
 
 ## Formal - Inativo
 
 matriz_formal_inativo = matrizes %>%
   filter(posicao_inicial == 1 &
            posicao_final == 3) %>%
   mutate(educ = as.character(educ))
 
 graf_f_inat = ggplot(matriz_formal_inativo, aes(x = trim, y = 100*transition, 
                                   color = educ, group = educ)) +
   scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
                                 "Completed Primary School and Incompleted High School",
                                 "Completed High School and Incompleted College Degree",
                                 "Completed College Degree"), values = carto_pal(name = "Vivid")) +
   geom_line(size = 2) +
   geom_point(size = 2) +
   labs(x = "", y = "", title = "Formal to Inactive (%)") +
   theme_minimal() +
   theme(text = element_text(family = "LM Roman 10"),
         plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
         legend.title = element_blank()) +
   scale_x_discrete(breaks = paste0(2012:2021, "_1"),
                    labels = 2012:2021)
 
 
 ## Informal - Inativo
 
 matriz_informal_inativo = matrizes %>%
   filter(posicao_inicial == 2 &
            posicao_final == 3) %>%
   mutate(educ = as.character(educ))
 
 graf_i_inat = ggplot(matriz_informal_inativo, aes(x = trim, y = 100*transition, 
                                   color = educ, group = educ)) +
   scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
                                 "Completed Primary School and Incompleted High School",
                                 "Completed High School and Incompleted College Degree",
                                 "Completed College Degree"), values = carto_pal(name = "Vivid")) +
   geom_line(size = 2) +
   geom_point(size = 2) +
   labs(x = "", y = "", title = "Informal to Inactive (%)") +
   theme_minimal() +
   theme(text = element_text(family = "LM Roman 10"),
         plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
         legend.title = element_blank()) +
   scale_x_discrete(breaks = paste0(2012:2021, "_1"),
                    labels = 2012:2021)
 
 
 ## Informal para Formal
 
 matriz_informal_formal = matrizes %>%
   filter(posicao_inicial == 2 &
            posicao_final == 1) %>%
   mutate(educ = as.character(educ))
 
 graf_i_f = ggplot(matriz_informal_formal, aes(x = trim, y = 100*transition, 
                                                 color = educ, group = educ)) +
   scale_color_manual(labels = c("Uneducated and Incompleted Primary School",
                                 "Completed Primary School and Incompleted High School",
                                 "Completed High School and Incompleted College Degree",
                                 "Completed College Degree"), values = carto_pal(name = "Vivid")) +
   geom_line(size = 2) +
   geom_point(size = 2) +
   labs(x = "", y = "", title = "Informal to Formal (%)") +
   theme_minimal() +
   theme(text = element_text(family = "LM Roman 10"),
         plot.title = element_text(size = 13, face = "bold", hjust = 0.5),
         legend.title = element_blank()) +
   scale_x_discrete(breaks = paste0(2012:2021, "_1"),
                    labels = 2012:2021)
 
 